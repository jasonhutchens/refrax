#ifndef TRAIL_H
#define TRAIL_H

#include <grid.h>
#include <photon.h>

#include <SDL.h>

//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
class Trail
{
  public:
    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    enum Heading
    {
        N,
        NE,
        E,
        SE,
        W,
        SW,
        S,
        NW
    };

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    enum Type
    {
        P1,
        P2,
        P3,
        P4,
        BLAST
    };

    Trail();
    ~Trail();

    void init(void);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    bool update(void);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void draw(Grid<Photon>& grid);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    bool valid(void);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    bool active();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    Type getType();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void setType(Type type);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    Uint8 getX();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    Uint8 getY();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void setPos(Uint8 x, Uint8 y);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void setDelay(int delay);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    int getSpeed();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void setSpeed(int speed);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    Heading getHeading();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void setHeading(Heading heading);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void turnLeft();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void turnRight();

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    Uint32 getColour(SDL_Surface* surface);
  private:
    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void _setColour(unsigned i, Uint8 r, Uint8 g, Uint8 b);

    //--------------------------------------------------------------------------
    //--------------------------------------------------------------------------
    void _initColours();

    int     _delay;
    int     _speed;
    Type    _type;
    Heading _heading;
    bool    _valid;
    Uint8   _x[8];
    Uint8   _y[8];
    Uint8   _r[8];
    Uint8   _g[8];
    Uint8   _b[8];
};

#endif
